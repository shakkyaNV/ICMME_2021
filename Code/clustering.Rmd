---
title: "Clustering"
author: "HHDS"
date: "2/15/2021"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r}
library(tidyverse)
library(cluster)
library(factoextra)
```


```{r}
df_cluster<-read.csv("D:/Stat/ICMME/Data/heavy/df_fixed.csv")
```


```{r}
df_cluster_mean<-df_cluster %>% select(-c(1,3)) %>% group_by(Code) %>%
  summarise_all(mean)

df_cluster_scaled<- scale(df_cluster_mean[,-1])
```


```{r}
#optimal number of clusters
fviz_nbclust(df_cluster_scaled, kmeans, method = "silhouette")+
  labs(subtitle = "Silhouette method")

#k-means clustering (k=3)
set.seed(8085)
model_kmeans<-kmeans(df_cluster_scaled, centers = 3)
row.names(df_cluster_scaled)<-df_cluster_mean$Code
```


```{r}
#Visualization
fviz_cluster(model_kmeans, data = df_cluster_scaled )

```

```{r}
data.frame(
  "cluster_no"= model_kmeans$cluster,
  "landuse"= row.names(df_cluster_scaled)
  )%>% arrange(cluster_no)
```

