---
title: "Ordinal Logistic Regression"
author: "Harshani De Silva"
date: "1/25/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, commments = NULL)

```


```{r libs}
library(tidyverse)
library(tidymodels)
library(MASS)
library(caret)
```


### Load data
```{r}

df <- read_csv("../Data/heavy/merge_final.csv") %>% select(-1)
df %>% head()
```
```{r}


df %<>% mutate(
  award = replace_na(award, "Not awarded"),
  award = as.factor(award)
  ) %>% select(-c(1,2))

df[,1]<-ordered(recode(df$award,"Not awarded"=0, "Honourable mention"=1,"Bronze medal"=2,"Silver medal"=3,"Gold medal"=4))

#normalization
preproc<-preProcess(df[,-1],method= c("center","scale"))
df[,-1]<-predict(preproc, df[,-1])
df %>% head()
  
```



```{r}
set.seed(808)

split_initial <- initial_split(df, 
                               prop = 0.75)

split_train <- training(split_initial)
split_test <- testing(split_initial)
```



```{r}
split_train %>% dim()
split_test %>% dim()
```

```{r}
split_train[, 1:4] %>% str()
```


```{r}
df_recipe <- split_train[,] %>% 
  recipe(award ~ .) %>% # predicting award
  step_nzv(all_numeric()) %>% 
  prep()

juice(df_recipe) %>% head()
```


```{r}
#OLS model fitting
model_ols<-polr(award~.,data=split_train[,c(1,25:35)], method = "logistic")
#summary(model_ols)
predicted<-predict(model_ols, split_test)
table(split_test$award,predicted)
```


